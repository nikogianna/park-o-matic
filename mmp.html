<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="initial-scale=1.0">
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js" integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og==" crossorigin=""></script>
  <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>

  <link rel="stylesheet" type="text/css" href="mystyle.css">

  <title>Simulation</title>
</head>

<body>
  <div id="mapid"></div>

  <form id="time-form">
    <div class="form-group">
      <label for="input-spots">Time To Start From:</label>
      <input class="form-inline" id="time" name="time" type="number" min="0" max="23" step="1" aria-describedby="helpBlock">
      <small id="helpBlock" class="text-muted">
        Must be a number between 0 and 23.
      </small>
    </div>
    <button class="btn btn-primary" id="button-submit" type="button">Start Sim</button>
  </form>

  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>

<script type="text/javascript" src='lala.js'></script>
<script type="text/javascript" src='map.js'></script>


<script type="text/javascript">
  $("#button-submit").click(function(e) {
    e.preventDefault();
    $.ajax({
      type: "POST",
      url: "/sim_resp.php",
      data: $("#time-form").serialize(),
      success: function(result) {

        // alert(result);
        // var jsonObj = JSON.stringify(JSON.parse(result));
        var jsonObj = JSON.parse(result);

        // alert(jsonObj);
        var spots = [];
        // var spots = [];
        var ids = [];

        // var polyg = geojsonFeature.features[];

        for (var i = 0; i < jsonObj.polygons.length; i++) {
          // ids[i + 1] = jsonObj.polygons[i].id;
          spots[i + 1] = jsonObj.polygons[i].taken_spots;
          // polyg.
          // alert(jsonObj.polygons[i].id);

        }
        // alert(jsonObj.polygons[0].id);

        // if (geojsonFeature !== null) {

        // for (var i = 0; i < geojsonFeature.features.length; i++) {

        // var polyg = geojsonFeature.features[i];
        // var properties = geojsonFeature.features[i].properties;
        // if (spots[i + 1] !== 'null') {
        //   polyg.setStyle({
        //     color: "#4B1BDE"
        //   });

        geojson.eachLayer(function(layer) {
          if (spots[layer.feature.properties.id] !== 'null') {
            layer.setStyle({
              fillColor: 'blue'
            });
          }
        });
        geojson = L.geoJson(geojsonFeature, {
          style: myStyle,
          onEachFeature: onEachFeature2
        }).addTo(mymap);
        // alert("We have a match");
        // alert(ids[i + 1]);
        // alert(properties.id);
        // }



        // }
        alert(spots[2364]);

      },
      error: function(result) {
        alert('error');
      }
    });
  });
</script>

</html>